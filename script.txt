// --- CONFIGURATION ---
const SHEET_ID = "1YruRXxDyLtFyy43VDvg0-GZhkb9l9HhaRqjUFfjqKOs"; // Updated Sheet ID
// ---------------------

function doPost(e) {
  try {
    // 1. Parse incoming JSON data
    const data = JSON.parse(e.postData.contents);
    const date = new Date();
    
    // 2. Save to Google Sheet
    // Appending: Date | Name | Phone | Institute | Email | Plan | Goal
    const sheet = SpreadsheetApp.openById(SHEET_ID).getSheetByName('Sheet1');
    sheet.appendRow([
      date, 
      data.name, 
      data.phone, 
      data.institute, 
      data.email, 
      data.plan,  // Now including the Selected Plan
      data.goal
    ]);
    
    // 3. Return Success Response
    return ContentService.createTextOutput(JSON.stringify({ status: "success" }))
      .setMimeType(ContentService.MimeType.JSON);
      
  } catch (error) {
    // Return Error Response
    return ContentService.createTextOutput(JSON.stringify({ status: "error", message: error.toString() }))
      .setMimeType(ContentService.MimeType.JSON);
  }
}
